# -----------------------------------------------------------------------------
# 安全警告：不要使用默认密码进行部署
# 对于非本地（生产环境）部署，请务必将所有密码（ELASTIC_PASSWORD, 
# MYSQL_PASSWORD, MINIO_PASSWORD 等）更改为高强度的唯一值。
# 你可以使用以下命令生成随机字符串：openssl rand -hex 32
# -----------------------------------------------------------------------------

# ------------------------------
# 启动时指定向量数据库类型的 Docker 环境变量
# (根据向量数据库类型，将使用相应的 docker compose profile)
# ------------------------------
# 使用的文档引擎类型。
# 可用选项：
# - `elasticsearch` (默认)
# - `infinity` (https://github.com/infiniflow/infinity)
# - `oceanbase` (https://github.com/oceanbase/oceanbase)
# - `opensearch` (https://github.com/opensearch-project/OpenSearch)
DOC_ENGINE=${DOC_ENGINE:-elasticsearch}

# 运行 DeepDoc 推理（Inference）的设备。
# 可用级别：
# - `cpu` (默认)
# - `gpu`
DEVICE=${DEVICE:-cpu}

# Docker Compose 的 Profiles 配置
COMPOSE_PROFILES=${DOC_ENGINE},${DEVICE}

# Elasticsearch 的版本。
STACK_VERSION=8.11.3

# Elasticsearch 服务暴露的主机名
ES_HOST=es01

# 用于将 Elasticsearch 服务暴露给宿主机的端口，
# 允许从外部访问运行在 Docker 容器内的服务。
ES_PORT=1200

# Elasticsearch 的密码。
# 警告：生产环境请修改此密码！
ELASTIC_PASSWORD=123456

# OpenSearch 服务暴露的主机名，设置时请不要与 elasticsearch 相同
OS_PORT=1201

# OpenSearch 服务暴露的主机名
OS_HOST=opensearch01

# OpenSearch 的密码。
# 要求：至少包含一个大写字母、一个小写字母、一个数字和一个特殊字符
OPENSEARCH_PASSWORD=Admin@123

# 用于将 Kibana 服务暴露给宿主机的端口，
# 允许从外部访问运行在 Docker 容器内的服务。
# 要启用 Kibana，你需要：
# 1. 确保 COMPOSE_PROFILES 包含 kibana，例如：COMPOSE_PROFILES=${COMPOSE_PROFILES},kibana
# 2. 注释掉或删除 docker-compose-base.yml 中 es 服务的以下配置：xpack.security.enabled、xpack.security.http.ssl.enabled、xpack.security.transport.ssl.enabled (详情见：https://www.elastic.co/docs/deploy-manage/security/self-auto-setup#stack-existing-settings-detected)
# 3. 将 conf/service_config.yaml 或 docker/service_conf.yaml.template 中的 es.hosts 调整为 'https://localhost:1200'
# 4. 启动成功后，在 es 容器中执行命令生成 kibana token：`bin/elasticsearch-create-enrollment-token -s kibana`，然后即可正常使用 kibana
KIBANA_PORT=6601

# 单个 Docker 容器运行时可以使用的最大内存量（字节）。
# 请根据宿主机的可用内存进行更新。
MEM_LIMIT=8073741824

# Infinity 服务暴露的主机名
INFINITY_HOST=infinity

# 暴露给宿主机的 Infinity API 端口
INFINITY_THRIFT_PORT=23817
INFINITY_HTTP_PORT=23820
INFINITY_PSQL_PORT=5432

# OceanBase 服务暴露的主机名
OCEANBASE_HOST=oceanbase
# 暴露 OceanBase 服务的端口
OCEANBASE_PORT=2881
# OceanBase 的用户名
OCEANBASE_USER=root
# OceanBase 的密码
OCEANBASE_PASSWORD=123456
# OceanBase 服务使用的文档数据库名称
OCEANBASE_DOC_DBNAME=ragflow_doc

# OceanBase 容器配置
OB_CLUSTER_NAME=${OB_CLUSTER_NAME:-ragflow}
OB_TENANT_NAME=${OB_TENANT_NAME:-ragflow}
OB_SYS_PASSWORD=${OCEANBASE_PASSWORD:-infini_rag_flow}
OB_TENANT_PASSWORD=${OCEANBASE_PASSWORD:-infini_rag_flow}
OB_MEMORY_LIMIT=${OB_MEMORY_LIMIT:-10G}
OB_SYSTEM_MEMORY=${OB_SYSTEM_MEMORY:-2G}
OB_DATAFILE_SIZE=${OB_DATAFILE_SIZE:-20G}
OB_LOG_DISK_SIZE=${OB_LOG_DISK_SIZE:-20G}

# MySQL 的密码。
# 警告：生产环境请修改此密码！
MYSQL_PASSWORD=123456
# MySQL 服务暴露的主机名
MYSQL_HOST=mysql
# MySQL 服务使用的数据库名称
MYSQL_DBNAME=rag_flow
# 用于将 MySQL 服务暴露给宿主机的端口，
# 允许从外部访问运行在 Docker 容器内的 MySQL 数据库。
MYSQL_PORT=5455
# 发送到 MySQL 服务器的通信数据包的最大大小
MYSQL_MAX_PACKET=1073741824

# MinIO 服务暴露的主机名
MINIO_HOST=minio
# 用于将 MinIO 控制台界面暴露给宿主机的端口，
# 允许从外部访问运行在 Docker 容器内的基于 Web 的控制台。
MINIO_CONSOLE_PORT=9001
# 用于将 MinIO API 服务暴露给宿主机的端口，
# 允许从外部访问运行在 Docker 容器内的 MinIO 对象存储服务。
MINIO_PORT=9000
# MinIO 的用户名。
# 如果更新此项，必须相应地修改 service_conf.yaml 中的 `minio.user` 条目。
MINIO_USER=rag_flow
# MinIO 的密码。
# 如果更新此项，必须相应地修改 service_conf.yaml 中的 `minio.password` 条目。
MINIO_PASSWORD=123456

# Redis 服务暴露的主机名
REDIS_HOST=redis
# 用于将 Redis 服务暴露给宿主机的端口，
# 允许从外部访问运行在 Docker 容器内的 Redis 服务。
REDIS_PORT=6379
# Redis 的密码。
REDIS_PASSWORD=123456

# 用于将 RAGFlow 的 HTTP API 服务暴露给宿主机的端口，
# 允许从外部访问运行在 Docker 容器内的服务。
SVR_WEB_HTTP_PORT=80
SVR_WEB_HTTPS_PORT=443
SVR_HTTP_PORT=9380
ADMIN_SVR_HTTP_PORT=9381
SVR_MCP_PORT=9382

# 要下载的 RAGFlow Docker 镜像。v0.22+ 版本不包含 Embedding 模型。
RAGFLOW_IMAGE=infiniflow/ragflow:v0.23.1

# 如果无法下载 RAGFlow Docker 镜像（可以使用以下国内镜像）：
# RAGFLOW_IMAGE=swr.cn-north-4.myhuaweicloud.com/infiniflow/ragflow:v0.23.1
# RAGFLOW_IMAGE=registry.cn-hangzhou.aliyuncs.com/infiniflow/ragflow:v0.23.1
#
# - 对于 `nightly` (每夜构建) 版本，请取消注释以下任一行：
# RAGFLOW_IMAGE=swr.cn-north-4.myhuaweicloud.com/infiniflow/ragflow:nightly
# RAGFLOW_IMAGE=registry.cn-hangzhou.aliyuncs.com/infiniflow/ragflow:nightly

# Embedding (嵌入) 服务的镜像、模型和端口。
# 重要：要启用 Embedding 服务，你需要取消注释以下两行之一：
# COMPOSE_PROFILES=${COMPOSE_PROFILES},tei-cpu
# COMPOSE_PROFILES=${COMPOSE_PROFILES},tei-gpu

# Embedding 服务镜像：
TEI_IMAGE_CPU=infiniflow/text-embeddings-inference:cpu-1.8
TEI_IMAGE_GPU=infiniflow/text-embeddings-inference:1.8

# Embedding 服务模型：
# 可用选项：
# - `Qwen/Qwen3-Embedding-0.6B` (默认，需要 25GB RAM/vRAM 来加载)
# - `BAAI/bge-m3` (需要 21GB RAM/vRAM 来加载)
# - `BAAI/bge-small-en-v1.5` (需要 1.2GB RAM/vRAM 来加载)
TEI_MODEL=${TEI_MODEL:-Qwen/Qwen3-Embedding-0.6B}

# Embedding 服务端口配置：
TEI_HOST=tei
# 用于将 TEI 服务暴露给宿主机的端口，
# 允许从外部访问运行在 Docker 容器内的服务。
TEI_PORT=6380

# 本地时区。
TZ=Asia/Shanghai

# 如果你访问 huggingface.co 受限，请取消注释以下行：
# HF_ENDPOINT=https://hf-mirror.com

# MacOS 优化
# 如果你的操作系统是 MacOS，请取消注释以下行：
# MACOS=1

# 上传到数据集或 RAGFlow 文件系统的每个文件的最大大小限制（字节）。
# 要更改 1GB 的文件大小限制，请取消注释下面的行并按需更新。
# MAX_CONTENT_LENGTH=1073741824
# 更新后，确保 nginx/nginx.conf 中的 `client_max_body_size` 也相应更新。
# 注意：`MAX_CONTENT_LENGTH` 和 `client_max_body_size` 均不设置上传到 Agent 的文件大小上限。
# 详见 https://ragflow.io/docs/dev/begin_component。

# 控制单个批次处理的文档数量。
# 如果未显式设置 DOC_BULK_SIZE，则默认为 4。
DOC_BULK_SIZE=${DOC_BULK_SIZE:-4}

# 定义生成 Embedding 时每批处理的项目数。
# 如果环境变量中未设置 EMBEDDING_BATCH_SIZE，则默认为 16。
EMBEDDING_BATCH_SIZE=${EMBEDDING_BATCH_SIZE:-16}

# RAGFlow 自身及其引入包的日志级别。
# 可用级别：
# - `DEBUG`
# - `INFO` (默认)
# - `WARNING`
# - `ERROR`
# 例如，以下行将 `ragflow.es_conn` 的日志级别更改为 `DEBUG`：
LOG_LEVELS=ragflow.es_conn=INFO

# 阿里云 OSS 配置
# STORAGE_IMPL=OSS
# ACCESS_KEY=xxx
# SECRET_KEY=eee
# ENDPOINT=http://oss-cn-hangzhou.aliyuncs.com
# REGION=cn-hangzhou
# BUCKET=ragflow65536

# 用户注册开关：
# - 启用注册：1
# - 禁用注册：0
REGISTER_ENABLED=1

# 重要：要启用沙箱（Sandbox），你需要取消注释以下两行：
# SANDBOX_ENABLED=1
# COMPOSE_PROFILES=${COMPOSE_PROFILES},sandbox

# 沙箱设置
# 请再次检查是否已将 `sandbox-executor-manager` 添加到 `/etc/hosts`
# 运行前拉取所需的基础镜像：
#   docker pull infiniflow/sandbox-base-nodejs:latest
#   docker pull infiniflow/sandbox-base-python:latest
# 我们默认的沙箱环境包括：
#   - Node.js 基础镜像：包含 axios
#   - Python 基础镜像：包含 requests, numpy, 和 pandas
# 如果使用非默认环境，请在下方指定自定义执行器镜像。
# SANDBOX_HOST=sandbox-executor-manager
# SANDBOX_EXECUTOR_MANAGER_IMAGE=infiniflow/sandbox-executor-manager:latest
# SANDBOX_EXECUTOR_MANAGER_POOL_SIZE=3
# SANDBOX_BASE_PYTHON_IMAGE=infiniflow/sandbox-base-python:latest
# SANDBOX_BASE_NODEJS_IMAGE=infiniflow/sandbox-base-nodejs:latest
# SANDBOX_EXECUTOR_MANAGER_PORT=9385
# SANDBOX_ENABLE_SECCOMP=false
# SANDBOX_MAX_MEMORY=256m # b, k, m, g
# SANDBOX_TIMEOUT=10s # s, m, 1m30s

# 启用 DocLing (文档解析工具)
USE_DOCLING=false

# 启用 Mineru (PDF解析工具)
# 取消注释这些行将尽可能自动添加 MinerU 到模型提供商中。
# 更多详情请参阅 https://ragflow.io/docs/faq#how-to-use-mineru-to-parse-pdf-documents
# MINERU_DELETE_OUTPUT=0   # 保留输出目录
# MINERU_BACKEND=pipeline  # 或你喜欢的其他后端

# pptx 支持 (.NET 全球化设置)
DOTNET_SYSTEM_GLOBALIZATION_INVARIANT=1

# 加密工具
# RAGFLOW_CRYPTO_ENABLED=true
# RAGFLOW_CRYPTO_ALGORITHM=aes-256-cbc # 可选 aes-256-cbc, aes-128-cbc, sm4-cbc 之一
# RAGFLOW_CRYPTO_KEY=ragflow-crypto-key